

        <h3>
            {{businessType === 'ying' ? '应收单' : '仓押单'}}详情  ID:{{currentOrderId}} - 业务线: {{currentOrder?.line}}

            <button type="button" class="btn btn-outline-secondary btn-sm float-right" [routerLink]="['/yingorders']" *ngIf="businessType === 'ying'">返回</button>
            <button type="button" class="btn btn-outline-secondary btn-sm float-right" [routerLink]="['/cangorders']" *ngIf="businessType === 'cang'">返回</button>
        </h3>


        <ul class="nav nav-tabs mb-4">
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 1" (click)="changeTab(1)">订单详情</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 2" (click)="changeTab(2)">核算月管理</a>
            </li>
            <li class="nav-item" *ngIf="businessType==='ying'">
                <a class="nav-link" [class.active]="currentTabIndex === 3" (click)="changeTab(3)">发运管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 4" (click)="changeTab(4)">发票管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 11" (click)="changeTab(11)">借款管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 12" (click)="changeTab(12)">付款管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 13" (click)="changeTab(13)">回款管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 14" (click)="changeTab(14)">还款管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 21" (click)="changeTab(21)">上游结算管理</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 22" (click)="changeTab(22)">下游结算管理</a>
            </li>
            <li class="nav-item" *ngIf="businessType==='ying'">
                <a class="nav-link" [class.active]="currentTabIndex === 23" (click)="changeTab(23)">运输方结算管理</a>
            </li>

            <li class="nav-item" *ngIf="businessType==='ying'">
                <a class="nav-link" [class.active]="currentTabIndex === 25" (click)="changeTab(25)">保证金管理</a>
            </li>

            <li class="nav-item">
                <a class="nav-link" [class.active]="currentTabIndex === 31" (click)="changeTab(31)">费用管理</a>
            </li>

            <li class="nav-item" *ngIf="businessType==='cang'">
                <a class="nav-link" [class.active]="currentTabIndex === 32" (click)="changeTab(32)">入库管理</a>
            </li>
            <li class="nav-item" *ngIf="businessType==='cang'">
                <a class="nav-link" [class.active]="currentTabIndex === 33" (click)="changeTab(33)">出库管理</a>
            </li>

        </ul>


        <div *ngIf="currentTabIndex === 1" >
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">业务线名称: {{currentOrder?.line }}</h5>

                    <div class="row mt-4">
                        <div class="col-4">
                            <p class="card-text">事业部门: {{currentOrder?.deptId | findKey : departmentList : 'name'}}</p>
                        </div>
                        <div class="col-4">
                            <p class="card-text">业务团队: {{currentOrder?.teamId | findKey : teamList : 'name'}}</p>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-4">
                            <p class="card-text">上游结算方式: {{currentOrder?.upstreamSettleMode | settleMode }}</p>
                        </div>
                        <div class="col-4">
                            <p class="card-text">下游结算方式: {{currentOrder?.downstreamSettleMode | settleMode}}</p>
                        </div>
                        <div class="col-4">
                            <p class="card-text">商品品类: {{currentOrder?.cargoType | cargoType }}</p>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-4">
                            <p class="card-text">主账务公司: {{currentOrder?.mainAccounting | findKey:partyList:'name' }}</p>
                        </div>
                        <div class="col-4">
                            <p class="card-text">上游供应商: {{currentOrder?.upstreamId | findKey:partyList:'name' }}</p>
                        </div>
                        <div class="col-4">
                            <p class="card-text">下游客户: {{currentOrder?.downstreamId | findKey:partyList:'name' }}</p>
                        </div>
                    </div>

                    <div class="row mt-4" *ngFor="let company of currentOrder?.orderPartyList">
                        <div class="col-12" >
                            <p class="card-text">参与方公司: {{company.custType | customerType}} - {{company.customerId | findKey : partyList : 'name'}}</p>
                        </div>
                    </div>

                </div>
            </div>


            <div class="card mt-3">
                <div class="card-body">

                    <form  [formGroup]="transferForm" (ngSubmit)="transferFormSubmit()" (keydown.enter)="$event.preventDefault()" >

                        <div class="form-row">
                            <div class="col-6">
                                <bs-select formControlName="userId" [fc]="transferForm.get('userId')" [label]="'订单权限移交给:'" [labelclass]="'col-4'" [inputclass]="'col-6'" [dirty]="ignoreDirty" [options]="userList" [error]="transferFormError.userId"></bs-select>
                            </div>

                            <div class="col-2">
                                <button type="submit" class="btn btn-info" >保存</button>
                            </div>
                        </div>
                    </form>

                </div>
            </div>

        </div>



        <app-unit  *ngIf="currentTabIndex === 2" [currentOrder]="currentOrder" [businessType]="businessType"></app-unit>
        <app-shipping  *ngIf="currentTabIndex === 3 && businessType==='ying'" [currentOrder]="currentOrder" [businessType]="businessType"></app-shipping>
        <app-invoice  *ngIf="currentTabIndex === 4" [currentOrder]="currentOrder" [businessType]="businessType" ></app-invoice>

        <app-borrow  *ngIf="currentTabIndex === 11" [currentOrder]="currentOrder" [businessType]="businessType" ></app-borrow>
        <app-payment  *ngIf="currentTabIndex === 12" [currentOrder]="currentOrder" [businessType]="businessType" ></app-payment>
        <app-repayment  *ngIf="currentTabIndex === 13" [currentOrder]="currentOrder" [businessType]="businessType" ></app-repayment>
        <app-huankuan  *ngIf="currentTabIndex === 14" [currentOrder]="currentOrder" [businessType]="businessType" ></app-huankuan>

        <app-settle  *ngIf="currentTabIndex === 21 && businessType==='ying'" [currentOrder]="currentOrder" [businessType]="businessType" [settleType]="'settlesellerupstream'"></app-settle>
        <app-settle  *ngIf="currentTabIndex === 22 && businessType==='ying'" [currentOrder]="currentOrder" [businessType]="businessType" [settleType]="'settlebuyerdownstream'"></app-settle>
        <app-settletraffic  *ngIf="currentTabIndex === 23 && businessType==='ying'" [currentOrder]="currentOrder" [businessType]="businessType" ></app-settletraffic>

        <app-settle  *ngIf="currentTabIndex === 21 && businessType==='cang'" [currentOrder]="currentOrder" [businessType]="businessType" [settleType]="'settlebuyerupstream'"></app-settle>
        <app-settle  *ngIf="currentTabIndex === 22 && businessType==='cang'" [currentOrder]="currentOrder" [businessType]="businessType" [settleType]="'settlesellerdownstream'"></app-settle>

        <app-deposit  *ngIf="currentTabIndex === 25" [currentOrder]="currentOrder" [businessType]="businessType" ></app-deposit>
        <app-expense  *ngIf="currentTabIndex === 31" [currentOrder]="currentOrder" [businessType]="businessType" ></app-expense>

        <app-warehouse  *ngIf="currentTabIndex === 32 && businessType==='cang'" [currentOrder]="currentOrder" [businessType]="businessType" [warehouseType]="'ruku'"></app-warehouse>
        <app-warehouse  *ngIf="currentTabIndex === 33 && businessType==='cang'" [currentOrder]="currentOrder" [businessType]="businessType" [warehouseType]="'chuku'"></app-warehouse>

